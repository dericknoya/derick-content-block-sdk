{"version":3,"file":"main.js","mappings":"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","sources":["webpack://tdxdemoblock/./node_modules/blocksdk/blocksdk.js","webpack://tdxdemoblock/./src/components/image-card.js","webpack://tdxdemoblock/webpack/bootstrap","webpack://tdxdemoblock/webpack/runtime/compat get default export","webpack://tdxdemoblock/webpack/runtime/define property getters","webpack://tdxdemoblock/webpack/runtime/hasOwnProperty shorthand","webpack://tdxdemoblock/./src/lib/api.js","webpack://tdxdemoblock/./src/components/templating-block-selector.js","webpack://tdxdemoblock/./src/components/image-selector.js","webpack://tdxdemoblock/./src/components/templating-block-fieldset.js","webpack://tdxdemoblock/./src/components/templating-block-app.js","webpack://tdxdemoblock/./src/lib/templating-block-utils.js","webpack://tdxdemoblock/./src/main.js"],"sourcesContent":["/*\n * Copyright (c) 2018, salesforce.com, inc.\n * All rights reserved.\n * Licensed under the BSD 3-Clause license.\n * For full license text, see LICENSE.txt file in the repo root  or https://opensource.org/licenses/BSD-3-Clause\n */\n\nvar SDK = function (config, whitelistOverride, sslOverride) {\n\t// config has been added as the primary parameter\n\t// If it is provided ensure that the other paramaters are correctly assigned\n\t// for backwards compatibility\n\tif (Array.isArray(config)) {\n\t\twhitelistOverride = config;\n\t\tsslOverride = whitelistOverride;\n\t\tconfig = undefined;\n\t}\n\n\tif (config && config.onEditClose) {\n\t\tthis.handlers = {\n\t\t\tonEditClose: config.onEditClose\n\t\t};\n\t\tconfig.onEditClose = true;\n\t}\n\n\tthis._whitelistOverride = whitelistOverride;\n\tthis._sslOverride = sslOverride;\n\tthis._messageId = 1;\n\tthis._messages = {\n\t\t0: function () {}\n\t};\n\tthis._readyToPost = false;\n\tthis._pendingMessages = [];\n\tthis._receiveMessage = this._receiveMessage.bind(this);\n\n\twindow.addEventListener('message', this._receiveMessage, false);\n\n\twindow.parent.postMessage({\n\t\tmethod: 'handShake',\n\t\torigin: window.location.origin,\n\t\tpayload: config\n\t}, '*');\n};\n\nSDK.prototype.execute = function execute (method, options) {\n\toptions = options || {};\n\n\tvar self = this;\n\tvar payload = options.data;\n\tvar callback = options.success;\n\n\tif (!this._readyToPost) {\n\t\tthis._pendingMessages.push({\n\t\t\tmethod: method,\n\t\t\tpayload: payload,\n\t\t\tcallback: callback\n\t\t});\n\t} else {\n\t\tthis._post({\n\t\t\tmethod: method,\n\t\t\tpayload: payload\n\t\t}, callback);\n\t}\n};\n\nSDK.prototype.getCentralData = function (cb) {\n\tthis.execute('getCentralData', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getContent = function (cb) {\n\tthis.execute('getContent', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getData = function (cb) {\n\tthis.execute('getData', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getUserData = function (cb) {\n\tthis.execute('getUserData', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.getView = function (cb) {\n\tthis.execute('getView', {\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setBlockEditorWidth = function (value, cb) {\n\tthis.execute('setBlockEditorWidth', {\n\t\tdata: value,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setCentralData = function (dataObj, cb) {\n\tthis.execute('setCentralData', {\n\t\tdata: dataObj,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setContent = function (content, cb) {\n\tthis.execute('setContent', {\n\t\tdata: content,\n\t\tsuccess: cb});\n};\n\nSDK.prototype.setData = function (dataObj, cb) {\n\tthis.execute('setData', {\n\t\tdata: dataObj,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.setSuperContent = function (content, cb) {\n\tthis.execute('setSuperContent', {\n\t\tdata: content,\n\t\tsuccess: cb\n\t});\n};\n\nSDK.prototype.triggerAuth = function (appID) {\n\tthis.getUserData(function (userData) {\n\t\tvar stack = userData.stack;\n\t\tif (stack.indexOf('qa') === 0) {\n\t\t\tstack = stack.substring(3,5) + '.' + stack.substring(0,3);\n\t\t}\n\t\tvar iframe = document.createElement('IFRAME');\n\t\tiframe.src = 'https://mc.' + stack + '.exacttarget.com/cloud/tools/SSO.aspx?appId=' + appID + '&restToken=1&hub=1';\n\t\tiframe.style.width= '1px';\n\t\tiframe.style.height = '1px';\n\t\tiframe.style.position = 'absolute';\n\t\tiframe.style.top = '0';\n\t\tiframe.style.left = '0';\n\t\tiframe.style.visibility = 'hidden';\n\t\tiframe.className = 'authframe';\n\t\tdocument.body.appendChild(iframe);\n\t});\n};\n\nSDK.prototype.triggerAuth2 = function (authInfo) {\n\tvar iframe = document.createElement('IFRAME');\n\tvar scope = '';\n\tvar state = '';\n\tif(Array.isArray(authInfo.scope)) {\n\t\tscope = '&scope=' + authInfo.scope.join('%20');\n\t}\n\tif(authInfo.state) {\n\t\tstate = '&state=' + authInfo.state;\n\t}\n\tiframe.src = authInfo.authURL + (authInfo.authURL.endsWith('/') ? '':'/') + 'v2/authorize?response_type=code&client_id=' + authInfo.clientId + '&redirect_uri=' + encodeURIComponent(authInfo.redirectURL) + scope + state;\n\tiframe.style.width= '1px';\n\tiframe.style.height = '1px';\n\tiframe.style.position = 'absolute';\n\tiframe.style.top = '0';\n\tiframe.style.left = '0';\n\tiframe.style.visibility = 'hidden';\n\tiframe.className = 'authframe';\n\tdocument.body.appendChild(iframe);\n};\n\n/* Internal Methods */\n\nSDK.prototype._executePendingMessages = function _executePendingMessages () {\n\tvar self = this;\n\n\tthis._pendingMessages.forEach(function (thisMessage) {\n\t\tself.execute(thisMessage.method, {\n\t\t\tdata: thisMessage.payload,\n\t\t\tsuccess: thisMessage.callback\n\t\t});\n\t});\n\n\tthis._pendingMessages = [];\n};\n\nSDK.prototype._post = function _post (payload, callback) {\n\tthis._messages[this._messageId] = callback;\n\tpayload.id = this._messageId;\n\tthis._messageId += 1;\n\t// the actual postMessage always uses the validated origin\n\twindow.parent.postMessage(payload, this._parentOrigin);\n};\n\nSDK.prototype._receiveMessage = function _receiveMessage (message) {\n\tmessage = message || {};\n\tvar data = message.data || {};\n\n\tif (data.method === 'handShake') {\n\t\tif (this._validateOrigin(data.origin)) {\n\t\t\tthis._parentOrigin = data.origin;\n\t\t\tthis._readyToPost = true;\n\t\t\tthis._executePendingMessages();\n\t\t\treturn;\n\t\t}\n\t} else if (data.method === 'closeBlock') {\n\t\tif (this._validateOrigin(data.origin)) {\n\t\t\t// here execute the method before closing the  block editing\n\t\t\t//onEditClose();\n\t\t\tif (this.handlers && this.handlers.onEditClose) {\n\t\t\t\tthis.handlers.onEditClose();\n\t\t\t}\n\t\t\tthis.execute('blockReadyToClose');\n\t\t\treturn;\n\t\t}\n\t}\n\n\t// if the message is not from the validated origin it gets ignored\n\tif (!this._parentOrigin || this._parentOrigin !== message.origin) {\n\t\treturn;\n\t}\n\t// when the message has been received, we execute its callback\n\t(this._messages[data.id || 0] || function () {})(data.payload);\n\tdelete this._messages[data.id];\n};\n\n// the custom block should verify it is being called from the marketing cloud\nSDK.prototype._validateOrigin = function _validateOrigin (origin) {\n\t// Make sure to escape periods since these strings are used in a regular expression\n\tvar allowedDomains = this._whitelistOverride || ['exacttarget\\\\.com', 'marketingcloudapps\\\\.com', 'blocktester\\\\.herokuapp\\\\.com'];\n\n\tfor (var i = 0; i < allowedDomains.length; i++) {\n\t\t// Makes the s optional in https\n\t\tvar optionalSsl = this._sslOverride ? '?' : '';\n\t\tvar mcSubdomain = allowedDomains[i] === 'exacttarget\\\\.com' ? 'mc\\\\.' : '';\n\t\tvar whitelistRegex = new RegExp('^https' + optionalSsl + '://' + mcSubdomain + '([a-zA-Z0-9-]+\\\\.)*' + allowedDomains[i] + '(:[0-9]+)?$', 'i');\n\n\t\tif (whitelistRegex.test(origin)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n};\n\nif (typeof(window) === 'object') {\n\twindow.sfdc = window.sfdc || {};\n\twindow.sfdc.BlockSDK = SDK;\n}\nif (typeof(module) === 'object') {\n\tmodule.exports = SDK;\n}\n","let template = document.createElement('template');\ntemplate.innerHTML = `\n<article class=\"slds-box slds-box\" style=\"cursor: pointer; height: 100%;\">\n\t<span class=\"name\" style=\"word-break: break-all;\"></span>\n\t<div class=\"slds-card__body slds-card__body_inner\">\n\t\t<img />\n\t</div>\n</article>\n`;\n\nclass ImageCard extends HTMLElement {\n\tconnectedCallback() {\n\t\tthis.appendChild(template.content.cloneNode(true));\n\n\t\tthis.getElementsByClassName('name')[0].innerText = this.getAttribute('name');\n\t\tthis.getElementsByTagName('img')[0].src = this.getAttribute('url');\n\n\t\tthis.addEventListener('click', () => {\n\t\t\tthis.dispatchEvent(new CustomEvent('change', {\n\t\t\t\tdetail: {\n\t\t\t\t\tvalue: this.getAttribute('url')\n\t\t\t\t},\n\t\t\t\tbubbles: true\n\t\t\t}));\n\t\t});\n\t}\n}\n\ncustomElements.define('image-card', ImageCard);\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","async function post(url, data) {\n  const response = await fetch(\"/proxy/\" + url, {\n    method: \"POST\",\n    body: JSON.stringify(data),\n  });\n  return await response.json();\n}\n\nexport async function getBlock(id) {\n  const response = await fetch(`/proxy/asset/v1/content/assets/${id}`);\n  return await response.json();\n}\n\nexport async function getCustomTemplates() {\n  return await post(\"asset/v1/content/assets/query\", {\n    query: {\n      property: \"tags\",\n      simpleOperator: \"where\",\n      value: \"customblocktemplate\",\n    },\n  });\n}\n\nfunction getImagesCached() {\n  let images;\n  return async () => {\n    if (!images) {\n      images = post(\"asset/v1/content/assets/query\", {\n        query: {\n          property: \"assetType.id\",\n          simpleOperator: \"in\",\n          value: [20, 22, 23, 28],\n        },\n      });\n    }\n    return images;\n  };\n}\n\nexport const getImages = getImagesCached();\n","import { getCustomTemplates } from '../lib/api';\n\nconst template = document.createElement('template');\ntemplate.innerHTML = `\n<fieldset class=\"slds-form-element slds-box slds-m-bottom_x-small\">\n  <legend class=\"slds-form-element__legend slds-form-element__label\">Choose a block template</legend>\n  <div class=\"slds-form-element__control\">\n  </div>\n</fieldset>\n`;\n\nclass TemplatingBlockSelector extends HTMLElement {\n\tasync connectedCallback() {\n\t\tthis.appendChild(template.content.cloneNode(true));\n\n\t\tthis.querySelector('.slds-form-element__control').addEventListener('change', e => {\n\t\t\te.stopPropagation();\n\t\t\tif (assets) {\n\t\t\t\tthis.dispatchEvent(new CustomEvent('change', {\n\t\t\t\t\tdetail: {\n\t\t\t\t\t\ttemplate: assets.items.find(asset => e.target.value == asset.id)\n\t\t\t\t\t},\n\t\t\t\t\tbubbles: false\n\t\t\t\t}));\n\t\t\t}\n\t\t});\n\n\t\tconst assets = await getCustomTemplates();\n\n\t\tthis.querySelector('.slds-form-element__control').innerHTML = assets.items.map(this.getRadioHtml).join('');\n\t\tif (this.assetId) {\n\t\t\tdocument.getElementById(this.assetId).checked = 'checked';\n\t\t}\n\t}\n\n\tgetRadioHtml(asset) {\n\t\treturn `\n<span class=\"slds-radio\">\n\t<input type=\"radio\" id=\"${asset.id}\" value=\"${asset.id}\" name=\"template\" />\n\t<label class=\"slds-radio__label\" for=\"${asset.id}\">\n\t\t<span class=\"slds-radio_faux\"></span>\n\t\t<span class=\"slds-form-element__label\">${asset.name}</span>\n\t</label>\n</span>`;\n\t}\n}\n\ncustomElements.define('templating-block-selector', TemplatingBlockSelector);\n","import { getImages } from '../lib/api';\nimport './image-card';\n\nconst template = document.createElement('template');\ntemplate.innerHTML = `\n<button class=\"slds-button slds-button_neutral\">Select</button>\n<div class=\"slds-grid slds-gutters slds-wrap slds-grid_vertical-stretch\" style=\"display: none;\"></div>\n`;\n\nclass ImageSelector extends HTMLElement {\n\tconstructor () {\n\t\tsuper();\n\n\t\tthis._toggleSelector = this._toggleSelector.bind(this);\n\t}\n\n\tasync connectedCallback() {\n\t\tthis.appendChild(template.content.cloneNode(true));\n\t\tthis.grid = this.getElementsByClassName('slds-grid')[0];\n\n\t\tthis.getElementsByTagName('button')[0].addEventListener('click', this._toggleSelector);\n\n\t\tthis.addEventListener('change', e => {\n\t\t\tthis.value = e.detail.value;\n\t\t\tthis._toggleSelector();\n\t\t});\n\n\t\tconst images = await getImages();\n\t\tthis.grid.innerHTML = images.items.map(this._getImageHTML).join('');\n\t}\n\n\t_getImageHTML(image) {\n\t\treturn `\n<div class=\"slds-col slds-size_1-of-2 slds-p-top_x-small\">\n\t<image-card id=\"${image.id}\" name=\"${image.name}\" url=\"${image.fileProperties.publishedURL}\"></image-card>\n</div>\n\t\t`;\n\t}\n\n\t_toggleSelector() {\n\t\tthis.grid.style.display = this.grid.style.display === 'none' ? 'flex' : 'none';\n\t}\n}\n\ncustomElements.define('image-selector', ImageSelector);\n","import './image-selector';\n\nconst template = document.createElement('template');\ntemplate.innerHTML = `\n<div class=\"slds-box\">\n</div>\n`;\n\nclass TemplatingBlockFieldSet extends HTMLElement {\n\tset fields(val) {\n\t\tif (val) {\n\t\t\tthis.firstElementChild.innerHTML = val.map(this.getFieldHtml).join('');\n\t\t\tthis._fields = val;\n\t\t}\n\t}\n\n\tasync connectedCallback() {\n\t\tthis.appendChild(template.content.cloneNode(true));\n\n\t\tthis.firstElementChild.addEventListener('change', e => {\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatchEvent(new CustomEvent('change', {\n\t\t\t\tdetail: {\n\t\t\t\t\tfields: this._fields.map(\n\t\t\t\t\t\t(field, idx) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...field,\n\t\t\t\t\t\t\t\tvalue: this.querySelector(`#template-field-${idx}`).value\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t)\n\t\t\t\t},\n\t\t\t\tbubbles: false\n\t\t\t}));\n\t\t});\n\t}\n\n\tgetFieldHtml(field, idx) {\n\t\treturn `\n<div class=\"slds-form-element\">\n\t<label class=\"slds-form-element__label\" for=\"template-field-${idx}\">${field.title}</label>\n\t<div class=\"slds-form-element__control\">\n\t\t${field.type === 'image' ?\n\t\t\t'<image-selector ' :\n\t\t\t'<input type=\"text\" class=\"slds-input\" '\n\t\t} id=\"template-field-${idx}\" value=\"${field.value || ''}\" />\n\t</div>\n</div>\n`;\n\t}\n}\n\ncustomElements.define('templating-block-fieldset', TemplatingBlockFieldSet);\n","import './templating-block-selector';\nimport './templating-block-fieldset';\n\nclass TemplatingBlockApp extends HTMLElement {\n\tset fields(val) {\n\t\tthis.fieldSet.fields = val;\n\t}\n\n\tconnectedCallback() {\n\t\tconst dispatchEvent = type => e =>\n\t\t\tthis.dispatchEvent(new CustomEvent('change', {\n\t\t\t\tdetail: {\n\t\t\t\t\t...e.detail,\n\t\t\t\t\ttype: type\n\t\t\t\t},\n\t\t\t\tbubbles: false\n\t\t\t}));\n\n\t\t// not using shadow DOM to avoid loading SLDS styles _everywhere_\n\t\tif (!this.locked) {\n\t\t\tconst selector = document.createElement('templating-block-selector');\n\t\t\tselector.assetId = this.assetId;\n\t\t\tthis.appendChild(selector);\n\t\t\tselector.addEventListener('change', dispatchEvent('template'));\n\t\t}\n\n\t\tthis.fieldSet = document.createElement('templating-block-fieldset');\n\t\tthis.appendChild(this.fieldSet);\n\n\t\tthis.fieldSet.addEventListener('change', dispatchEvent('fields'));\n\t}\n}\n\ncustomElements.define('templating-block-app', TemplatingBlockApp);\n","const placeholderRegex = /\\[\\[(\\w+)\\|([^|]+)\\|([^\\]]*)\\]\\]/g;\n\nexport function parseTemplate (template) {\n\tconst fields = [];\n\tlet match;\n\n\twhile (match = placeholderRegex.exec(template.content)) {\n\t\tfields.push({\n\t\t\ttype: match[1],\n\t\t\ttitle: match[2]\n\t\t});\n\t}\n\n\treturn fields;\n}\n\nexport function getHtml(template, fields = [], isFallback) {\n\tlet idx = 0;\n\treturn template.content.replace(placeholderRegex,\n\t\t(match, type, title, placeholder) => {\n\t\t\tlet replaceVal = '';\n\t\t\tif (fields[idx] && fields[idx].value) {\n\t\t\t\treplaceVal = fields[idx].value;\n\t\t\t} else if (isFallback) {\n\t\t\t\treplaceVal = placeholder;\n\t\t\t}\n\t\t\tidx++;\n\t\t\treturn replaceVal;\n\t\t}\n\t);\n}\n","import './components/templating-block-app';\nimport SDK from 'blocksdk';\nimport { getHtml, parseTemplate } from './lib/templating-block-utils';\nimport { getBlock } from './lib/api';\n\nconst sdk = new SDK();\n\nfunction initializeApp(data) {\n\tconst app = document.createElement('templating-block-app');\n\tapp.locked = data.locked;\n\tif (data.template) {\n\t\tapp.assetId = data.template.id;\n\t}\n\n\t// respond to app changes\n\tapp.addEventListener('change', e => {\n\t\t// always get current data\n\t\tsdk.getData(blockData => {\n\t\t\tconst newBlockData = blockData;\n\n\t\t\t// extend current data with new data\n\t\t\tswitch (e.detail.type) {\n\t\t\t\tcase 'template':\n\t\t\t\t\tnewBlockData.template = e.detail.template;\n\t\t\t\t\tnewBlockData.fields = parseTemplate(newBlockData.template);\n\t\t\t\t\tapp.fields = newBlockData.fields;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'fields':\n\t\t\t\t\tnewBlockData.fields = e.detail.fields;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tsetEverything(newBlockData);\n\t\t});\n\t});\n\n\tdocument.getElementById('workspace').appendChild(app);\n\tapp.fields = data.fields;\n}\n\nfunction setEverything(data) {\n\t// always set data with latest\n\tsdk.setData(data);\n\t// set content with latest changes\n\tsdk.setContent(getHtml(data.template, data.fields, false));\n\t// update preview to use latest, with placeholders for preview\n\tsdk.setSuperContent(getHtml(data.template, data.fields, true));\n}\n\nasync function getOverrideData(data, assetId) {\n\tdata.template = await getBlock(assetId);\n\tdata.fields = parseTemplate(data.template).map((field, idx) => {\n\t\treturn {\n\t\t\t...field,\n\t\t\tvalue: data.fields && data.fields[idx] && data.fields[idx].value || ''\n\t\t};\n\t});\n\tdata.locked = true;\n\n\treturn data;\n}\n\nsdk.getData(async (data) => {\n\tif (window.app.assetId) {\n\t\tconst overrideData = await getOverrideData(data, window.app.assetId);\n\t\tsetEverything(overrideData);\n\t}\n\n\tinitializeApp(data);\n});\n\nsdk.triggerAuth(window.app.appID);\n"],"names":["SDK","config","whitelistOverride","sslOverride","Array","isArray","undefined","onEditClose","this","handlers","_whitelistOverride","_sslOverride","_messageId","_messages","_readyToPost","_pendingMessages","_receiveMessage","bind","window","addEventListener","parent","postMessage","method","origin","location","payload","prototype","execute","options","data","callback","success","_post","push","getCentralData","cb","getContent","getData","getUserData","getView","setBlockEditorWidth","value","setCentralData","dataObj","setContent","content","setData","setSuperContent","triggerAuth","appID","userData","stack","indexOf","substring","iframe","document","createElement","src","style","width","height","position","top","left","visibility","className","body","appendChild","triggerAuth2","authInfo","scope","state","join","authURL","endsWith","clientId","encodeURIComponent","redirectURL","_executePendingMessages","self","forEach","thisMessage","id","_parentOrigin","message","_validateOrigin","allowedDomains","i","length","optionalSsl","mcSubdomain","RegExp","test","sfdc","BlockSDK","module","exports","template","innerHTML","ImageCard","HTMLElement","connectedCallback","cloneNode","getElementsByClassName","innerText","getAttribute","getElementsByTagName","dispatchEvent","CustomEvent","detail","bubbles","customElements","define","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","hasOwnProperty","call","async","post","url","response","fetch","JSON","stringify","json","getImages","images","query","property","simpleOperator","getImagesCached","TemplatingBlockSelector","querySelector","e","stopPropagation","assets","items","find","asset","target","getCustomTemplates","map","getRadioHtml","assetId","getElementById","checked","name","ImageSelector","constructor","super","_toggleSelector","grid","_getImageHTML","image","fileProperties","publishedURL","display","TemplatingBlockFieldSet","fields","val","firstElementChild","getFieldHtml","_fields","field","idx","title","type","TemplatingBlockApp","fieldSet","locked","selector","placeholderRegex","parseTemplate","match","exec","getHtml","isFallback","replace","placeholder","replaceVal","sdk","setEverything","app","getBlock","getOverrideData","blockData","newBlockData","initializeApp"],"sourceRoot":""}